rule1 <- function(x){
prediction <- rep(NA,length(x))
prediction[x > 2.7] <- "spam"
prediction[x < 2.40] <- "nonspam"
prediction[(x >= 2.40 & x <= 2.45)] <- "spam"
prediction[(x > 2.45 & x <= 2.70)] <- "nonspam"
return(prediction)
}
rule1(smallSpam$capitalAve)
table(rule1(smallSpam$capitalAve))
table(smallSpam$type)
?table
rule1 <- function(x){
prediction <- rep(NA,length(x))
prediction[x > 2.7] <- "spam"
prediction[x < 2.40] <- "nonspam"
prediction[(x >= 2.40 & x <= 2.45)] <- "spam"
prediction[(x > 2.45 & x <= 2.70)] <- "nonspam"
return(prediction)
}
table(rule2(smallSpam$capitalAve))
rule2 <- function(x){
prediction <- rep(NA,length(x))
prediction[x > 2.8] <- "spam"
prediction[x <= 2.8] <- "nonspam"
return(prediction)
}
table(rule2(smallSpam$capitalAve))
table(smallSpam$type)
table(rule2(smallSpam$capitalAve),smallSpam$type)
q()
install.packages("caret")
q()
install.packages("ISLR")
library(caret)
library(ISLR)
data("Wage")
summary(Wage)
inTrain <- createDataPartition(y=Wage$wage, p=0.7, list = F)
inTrain
training <- Wage[inTrain,]
testing <- Wage[-inTrain,]
featurePlot(x=training[,c("age","education","jobclass")])
featurePlot(x=training[,c("age","education","jobclass")], y=training$wage, plot = "pairs")
qplot(age,wage,data = training)
qplot(age,wage,colour=jobclass,data = training)
qq <- qplot(age,wage,colour=jobclass,data = training)
qq + geom_smooth(method = "lm", formula=y~x)
library(Hmisc)
cutWage <- cut2(training$wage,g=3)
table(cutWage)
qplot(cutWage, age, data = training, fill=cutWage, geom = "boxplot")
p1 <- qplot(cutWage, age, data = training, fill=cutWage, geom = "boxplot")
p2 <- qplot(cutWage, age, data = training, fill=cutWage, geom = "jitter")
grid.arrange(p1,p2,ncol=2)
library(ggplot2)
grid.arrange(p1,p2,ncol=2)
require("gridExtra")
grid.arrange(p1,p2,ncol=2)
cutWage2 <- cut2(training$wage,g=3)
table(cutWage)
table(cutWage2)
qplot(cutWage, age, data = training)
qplot(cutWage, age, data = training, geom = "scatterplot")
?qplot
qplot(cutWage, age, data = training, geom = "jitter")
qplot(cutWage, age, data = training, colour = jobclass)
qplot(cutWage, age, data = training, geom = "boxplot", colour = jobclass)
qplot(cutWage, age, data = training, geom = "histogram", colour = jobclass)
qplot(cutWage, age, data = training, geom = "hist", colour = jobclass)
p1
inTrain
View(Wage)
Wage$race
table(Wage$race)
density(Wage$race)
density(table(Wage$race))
qplot(Wage$race, table(Wage$race))
q()
q()
library(caret)
library(kernlab)
data("spam")
inTrain <- createDataPartition(y=spam, p=0.75, list = F)
inTrain <- createDataPartition(y=spam$type, p=0.75, list = F)
taining <- spam[inTrain,]
taining
M <- abs(cor(taining[,-58]))
M
diag(M) <- 0
M
M[34,32]
M[32,34]
which(M > 0.8, arr.ind = T)
M$num415
M[34,32]
M[32,34]
spam[,34]
spam[,32]
which(M > 0.8, arr.ind = T)
names(spam)[c(32,34,40)]
spam[c(32,34,40)]
which(M > 0.8, arr.ind = T)
plot(spam[,32], spam[,34])
plot(spam[,32], spam[,40])
plot(spam[,34], spam[,40])
spam[,32]
spam[34]
spam[34,32]
which(M > 0.8, arr.ind = T)
M[34,32]
training$num415
taining$num415
q()
library(caret)
?createFolds
library(AppliedPredictiveModeling)
data("segmentationOriginal")
inTrain <- createDataPartition(segmentationOriginal$Case, p=0.7, list = F )
training <- segmentationOriginal[inTrain,]
testing <- segmentationOriginal[-inTrain,]
set.seed(125)
modfit <- train(Case ~ ., method = "rpart", data = segmentationOriginal)
View(segmentationOriginal)
modfit <- train(Class ~ ., method = "rpart", data = segmentationOriginal)
set.seed(125)
training <- subset(segmentationOriginal, Case== "Train")
training <- subset(segmentationOriginal, Case== "Train")
data("segmentationOriginal")
training <- subset(segmentationOriginal, Case== "Train")
testing <- subset(segmentationOriginal, Case == "Testing")
testing <- subset(segmentationOriginal, Case == "Test")
set.seed(125)
modfit <- train(Class ~ ., method = "rpart", data = segmentationOriginal)
modfit
print(modfit$finalModel)
library(pgmm)
install.packages("pgmm")
library(pgmm)
data(olive)
olive = olive[,-1]
View(olive)
modfit <- train(Area ~ ., method = "rpart", data = olive)
print(modfit$finalModel)
newdata = as.data.frame(t(colMeans(olive)))
View(newdata)
?tree
?tree
val <- predict(modfit, newdata = newdata)
val
library(ElemStatLearn)
install.packages("ElemStatLearn")
library(ElemStatLearn)
data(SAheart)
set.seed(8484)
train = sample(1:dim(SAheart)[1],size=dim(SAheart)[1]/2,replace=F)
trainSA = SAheart[train,]
testSA = SAheart[-train,]
set.seed(13234)
View(trainSA)
modfit <- train(chd ~ age + alcohol + obesity + tobacco + typea + ldl, data = trainSA, method = "glm", family = "binomial")
pred <- predict(chd ~ age + alcohol + obesity + tobacco + typea + ldl, data = testSA)
pred <- predict(modfit, data = testSA)
missClass = function(values,prediction){sum(((prediction > 0.5)*1) != values)/length(values)}
result <- missClass(trainSA$chd, pred)
result
result <- missClass(testSA$chd, pred)
result
pred2 <- predict(modfit, data = trainSA)
result2 <- missClass(trainSA$chd, pred2)
pred <- predict(modfit, data = testSA)
result <- missClass(testSA$chd, pred)
result <- missClass(testSA$chd, pred2)
result <- missClass(testSA$chd, pred2)
result <- missClass(testSA$chd, pred1)
result <- missClass(testSA$chd, pred2)
result <- missClass(testSA$chd, pred)
result
result2
result2 <- missClass(trainSA$chd, pred)
rm(result, result2)
result <- missClass(testSA$chd, pred)
result2 <- missClass(trainSA$chd, pred)
rm(result, result2)
set.seed(13234)
modfit <- train(chd ~ age + alcohol + obesity + tobacco + typea + ldl, data = trainSA, method = "glm", family = "binomial")
pred <- predict(modfit, data = testSA)
result <- missClass(testSA$chd, pred)
result <- missClass(testSA$chd, pred2)
set.seed(13234)
modfit <- train(chd ~ age + alcohol + obesity + tobacco + typea + ldl, data = trainSA, method = "glm", family = "binomial")
pred <- predict(modfit, data = testSA, type = "response")
pred <- predict(modfit, newdata = testSA, type = "response")
modfit <- train(chd ~ age + alcohol + obesity + tobacco + typea + ldl, data = trainSA, glm=list(family=binomial))
pred <- predict(modfit, newdata = testSA, type = "response")
require(earth)
modfit <- train(chd ~ age + alcohol + obesity + tobacco + typea + ldl, data = trainSA, glm=list(family=binomial))
rm(modfit)
modfit <- train(chd ~ age + alcohol + obesity + tobacco + typea + ldl, data = trainSA, degree = 1, glm=list(family=binomial))
pred <- predict(modfit, newdata = testSA, type = "response")
install.packages("earth")
set.seed(13234)
rm (modfit)
modfit <- train(chd ~ age + alcohol + obesity + tobacco + typea + ldl, data = trainSA, degree = 1, glm=list(family=binomial))
pred <- predict(modfit, newdata = testSA, type = "response")
modfit <- train(chd ~ age + alcohol + obesity + tobacco + typea + ldl, data = trainSA, degree = 1, method = "glm", family = "binomial")
modfit <- train(chd ~ age + alcohol + obesity + tobacco + typea + ldl, data = trainSA, method = "glm", family = "binomial")
modfit <- train(trainSA[,c(2,3,6,7,8,9)], trainSA$chd, data = trainSA, method = "glm", family = "binomial")
library(ElemStatLearn)
data(vowel.train)
data(vowel.test)
View(vowel.test)
vowel.test
str(vowel.test)
as.factor(vowel.test$y)
vowel.test$y <- as.factor(vowel.test$y)
str(vowel.test)
vowel.train$y <- as.factor(vowel.train$y)
set.seed(33833)
?randomForest
rf1 <- randomForest(x = vowel.train[,-1], y = vowel.train[,2:10], importance = T)
rf1 <- randomForest(x = vowel.train[,-1], importance = T)
rf1
print(rf1$importance)
print(rf1)
rf1 <- randomForest(y ~ ., data = vowel.train, importance = T)
rf1
print(rf1)
print(rf1)
print(rf1$importance)
print(rf1)
rf1 <- randomForest(y ~ ., data = vowel.train, mtry = 3, importance = T, na.action = na.omit)
print(rf1)
round(importance(rf1),2)
round(importance(rf1),2)
data("segmentationOriginal")
training <- subset(segmentationOriginal, Case== "Train")
testing <- subset(segmentationOriginal, Case == "Test")
set.seed(125)
modfit <- train(Class ~ ., method = "rpart", data = training)
modfit
modFit$finalModel
modfit$finalModel
library(pgmm)
data(olive)
olive = olive[,-1]
modfit <- train(Area ~ ., method = "rpart", data = olive)
newdata = as.data.frame(t(colMeans(olive)))
val <- predict(modfit, newdata = newdata)
library(ElemStatLearn)
data(SAheart)
set.seed(8484)
train = sample(1:dim(SAheart)[1],size=dim(SAheart)[1]/2,replace=F)
trainSA = SAheart[train,]
testSA = SAheart[-train,]
set.seed(13234)
modfit <- train(chd ~ age + alcohol + obesity + tobacco + typea + ldl, data = trainSA, method = "glm", family = "binomial")
pred <- predict(modfit, newdata = testSA)
missClass = function(values,prediction){sum(((prediction > 0.5)*1) != values)/length(values)}
result <- missClass(testSA$chd, pred)
pred2 <- predict(modfit, data = trainSA)
result2 <- missClass(trainSA$chd, pred2)
q()
q()
q()
q()
q()
q()
q()
q()
pop <- 1:1000
pop
n <- sample(pop, 100)
plot(n)
plot(pop)
sd(pop)
sd(n)
mean(pop)
mean(n)
mu <- mean(pop)
sig <- sd(pop)
lb <- mu - sig
ub <- mu + sig
in <- (pop > lb & pop < ub )
tween <- (pop > lb & pop < ub )
sum(tween)
tween / pop
ls
sum(tween)
578/1000
pop[tween,]
tween
?sd
sd
sig
var(pop)
sig^2
578/1000
cent<- pop - mu
cent / sig
stand <- cent / sig
plot(stand)
q()
library(swirl)
swirl()
exit
q()
install.packages("tidyverse")
install.packages("nycflights13")
library(nycflights13)
data("flights")
str(flights)
q()
install.packages("bookdown")
install.packages("gapminder")
install.packages("Lahman")
q()
q()
vignette("xtableGallery")
install.packages(c("assertthat", "backports", "chron", "curl", "data.table", "DBI", "devtools", "digest", "dplyr", "evaluate", "forecast", "formatR", "Hmisc", "htmltools", "jsonlite", "loo", "markdown", "matrixStats", "memoise", "mvtnorm", "quantmod", "R6", "Rcpp", "RcppEigen", "readr", "RMySQL", "rsconnect", "RSQLite", "rstan", "shiny", "shinyjs", "shinystan", "sourcetools", "SparseM", "sqldf", "StanHeaders", "stringi", "survival", "swirl", "tibble", "tidyr", "tseries", "viridis", "XML", "zoo"))
q()
mean()
mean
show
predict
lm
colSums
dgamma
show
predict
lm
dgamma
colSums
mean
q()
setwd("~/code/r/coursera/20170703_devDataProd/project")
setwd("~/code/r/coursera/20170703_devDataProd/project/test/shinyMPG")
shiny::runApp()
?mpg
?mtcars
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
?abline
model1 <- lm(mpg ~ wt, data = mtcars)
model1$coefficients[1]
model1$coefficients[2]
runApp()
runApp()
model1$coefficients[2]
runApp()
runApp()
runApp()
mtcars$wt
?predict
plot(model1)
pred1 <- predict(model1, newdata=mtcars$wt)
pred1 <- predict(model1, newdata=mtcars)
plot(pred1, xlab = "Weight (1,000 lbs)",ylab = "MPG")
pred1 <- predict(model1, newdata=data.frame(wt=mtcars$wt))
plot(pred1, xlab = "Weight (1,000 lbs)",ylab = "MPG")
mtcars(wt)
mtcars$wt
plot(mtcars$wt,mtcars$mpg)
runApp()
runApp()
runApp()
mtcars$disp
runApp()
runApp()
runApp()
runApp()
pred1
runApp()
runApp()
runApp()
model3 <- lm(mpg ~ wt + disp, data = mtcars)
plot(mtcars$mpg ~ mtcars$wt + mtcars$disp, xlab = "Weight and Displacement",ylab = "MPG")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
rm(list = ls())
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
model8 <- lm(mpg ~ wt + cyl + disp + hp, data = mtcars)
plot(model8)
plot(model8,newdata=data.frame(wt=mtcars$wt,disp=mtcars$disp))
predict(model8,newdata=data.frame(wt=mtcars$wt,disp=mtcars$disp))
runApp()
runApp()
runApp()
pred3 <- predict(model3, mtcars)
model3 <- lm(mpg ~ wt + disp, data = mtcars)
predict(model3)
plot(mtcars$mpg,predict(model3))
plot(predict(model3) ~ mtcars$disp + mtcars$hp)
mtcars$wt
mtcars$cyl
runApp()
runApp()
mypred <- predict(model3, mtcars)
runApp()
mtcars$wt
runApp()
?legend
runApp()
mtcars$disp
log(mtcars$disp)
mtcars$wt
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
pred3 <- predict(model3, newdata=data.frame(wt=mtcars$wt,disp=log(mtcars$disp)))
pred3
runApp()
runApp()
runApp()
runApp()
pred3 <- predict(model3, newdata=data.frame(wt=mtcars$wt,disp=log(mtcars$disp)))
plot(log(mtcars$disp),mtcars$mpg,type = "n", xlab = "Weight and Displacement",ylab = "MPG")
points(mtcars$wt, mtcars$mpg, col="red")
points(log(mtcars$disp), mtcars$mpg, col="blue")
lines(log(mtcars$disp),pred3,col="blue", lwd=2)
plot(log(mtcars$disp),mtcars$mpg,type = "n", xlab = "Weight and Displacement",ylab = "MPG")
points(mtcars$wt, mtcars$mpg, col="black")
points(log(mtcars$disp), mtcars$mpg, col="blue")
abline(log(mtcars$disp),pred3,col="blue", lwd=2)
abline(model3,col="blue", lwd=2)
abline(model3,col="black", lwd=2)
runApp()
model3 <- lm(mpg ~ wt + log(disp), data = mtcars)
plot(log(mtcars$disp),mtcars$mpg,type = "n", xlab = "Weight and Displacement",ylab = "MPG")
points(mtcars$wt, mtcars$mpg, col="black")
points(log(mtcars$disp), mtcars$mpg, col="blue")
abline(model3,col="black", lwd=2)
runApp()
abline(lm(mpg ~ wt + log(disp), data = mtcars))
abline(lm(mpg ~ log(disp) + wt, data = mtcars))
runApp()
runApp()
runApp()
runApp()
mtcars$hp
mtcars(log(hp))
log(mtcars$hp)
mtcars$wt
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
mtcars$cyl
runApp()
plot(mtcars$cyl, mtcars$mpg, type = "n", xlab = "Weight/Cylinders/Displacement",ylab = "MPG")
points(mtcars$wt, mtcars$mpg, col="black")
points(mtcars$cyl, mtcars$mpg, col="blue")
points(log(mtcars$disp), mtcars$mpg, col="red")
model5 <- lm(mpg ~ cyl + wt + log(disp), data = mtcars)
abline(model5$coefficients[1],model5$coefficients[2])
predict(model5,newdata = mtcars)
abline(lm(mpg~ log(disp) + cyl + wt, data = mtcars))
abline(lm(mpg ~ log(disp) + cyl + wt, data = mtcars))
model6 <- lm(mpg ~ wt + cyl + hp, data = mtcars)
pred6 <- predict(model6, mtcars)
pred5 <- predict(model5, mtcars)
runApp()
str(mtcars)
log(mtcars$disp)
runApp()
runApp()
runApp()
runApp()
q()
